<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Agaonline ğŸ‡¹ğŸ‡· - ArkadaÅŸlarÄ±nla Oyna</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="darkmode.css">
    <style>
        /* Hardware Acceleration & Performance */
        * {
            -webkit-transform: translateZ(0);
            -moz-transform: translateZ(0);
            -ms-transform: translateZ(0);
            -o-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            -webkit-perspective: 1000;
            perspective: 1000;
        }
        
        html, body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            will-change: transform;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Main Menu Screen -->
        <div id="mainMenu" class="screen active">
            <!-- Animated Background -->
            <div class="animated-bg">
                <div class="bg-circle bg-circle-1"></div>
                <div class="bg-circle bg-circle-2"></div>
                <div class="bg-circle bg-circle-3"></div>
            </div>

            <div class="menu-wrapper">
                <div class="menu-container">
                    <!-- Hero Header -->
                    <div class="menu-header-hero">
                        <div class="hero-badge">
                            <span class="badge-icon">ğŸ¯</span>
                            <span class="badge-text">TÃ¼rkiye'nin #1 Online Monopoly Oyunu</span>
                        </div>
                        <h1 class="game-title-hero">
                            <span class="title-icon">ğŸ’°</span>
                            AGAONLINE
                            <span class="title-flag">ğŸ‡¹ğŸ‡·</span>
                        </h1>
                        <p class="game-subtitle-hero">
                            <span class="subtitle-highlight">ArkadaÅŸlarÄ±nla</span> anlÄ±k stratejik mÃ¼cadele
                        </p>
                        <button id="darkModeToggle" class="btn-dark-mode-hero" onclick="toggleDarkMode()" title="Tema deÄŸiÅŸtir">
                            <span>ğŸŒ™</span>
                        </button>
                    </div>
                    
                    <!-- Game Setup Card -->
                    <div class="game-setup-card">
                        <div class="card-header">
                            <h3>âš¡ HÄ±zlÄ± BaÅŸlat</h3>
                        </div>
                        
                        <div class="menu-form">
                            <div class="input-group">
                                <label class="input-label">
                                    <span class="label-icon">ğŸ‘¤</span>
                                    <span>Oyuncu AdÄ±</span>
                                </label>
                                <input type="text" id="playerNameInput" placeholder="AdÄ±nÄ± gir..." maxlength="20" class="input-field-modern">
                            </div>

                            <div class="input-group">
                                <label class="input-label">
                                    <span class="label-icon">ğŸ—ºï¸</span>
                                    <span>Oyun TahtasÄ±</span>
                                </label>
                                <select id="boardSelect" class="input-field-modern">
                                    <option value="dunya" selected>ğŸŒ DÃ¼nya HaritasÄ±</option>
                                    <option value="turkiye">ğŸ‡¹ğŸ‡· TÃ¼rkiye</option>
                                    <option value="istanbul">ğŸ•Œ Ä°stanbul</option>
                                    <option value="amerika">ğŸ‡ºğŸ‡¸ Amerika</option>
                                    <option value="avrupa">ğŸ‡ªğŸ‡º Avrupa</option>
                                    <option value="japonya">ğŸ‡¯ğŸ‡µ Japonya</option>
                                    <option value="cin">ğŸ‡¨ğŸ‡³ Ã‡in</option>
                                    <option value="kore">ğŸ‡°ğŸ‡· Kore</option>
                                    <option value="rusya">ğŸ‡·ğŸ‡º Rusya</option>
                                </select>
                            </div>
                            
                            <div class="input-group">
                                <label class="input-label">
                                    <span class="label-icon">ğŸ­</span>
                                    <span>Avatar SeÃ§imi</span>
                                </label>
                                <div class="avatar-grid-modern">
                                    <button class="avatar-btn-modern selected" data-appearance="ğŸ‘¤" onclick="selectAppearance('ğŸ‘¤')">
                                        <span class="avatar-emoji">ğŸ‘¤</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ©" onclick="selectAppearance('ğŸ©')">
                                        <span class="avatar-emoji">ğŸ©</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸš—" onclick="selectAppearance('ğŸš—')">
                                        <span class="avatar-emoji">ğŸš—</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ•" onclick="selectAppearance('ğŸ•')">
                                        <span class="avatar-emoji">ğŸ•</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ¸" onclick="selectAppearance('ğŸ¸')">
                                        <span class="avatar-emoji">ğŸ¸</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ‘‘" onclick="selectAppearance('ğŸ‘‘')">
                                        <span class="avatar-emoji">ğŸ‘‘</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ¤“" onclick="selectAppearance('ğŸ¤“')">
                                        <span class="avatar-emoji">ğŸ¤“</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ§™" onclick="selectAppearance('ğŸ§™')">
                                        <span class="avatar-emoji">ğŸ§™</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ‡" onclick="selectAppearance('ğŸ‡')">
                                        <span class="avatar-emoji">ğŸ‡</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ§›" onclick="selectAppearance('ğŸ§›')">
                                        <span class="avatar-emoji">ğŸ§›</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ‘»" onclick="selectAppearance('ğŸ‘»')">
                                        <span class="avatar-emoji">ğŸ‘»</span>
                                    </button>
                                    <button class="avatar-btn-modern" data-appearance="ğŸ¤–" onclick="selectAppearance('ğŸ¤–')">
                                        <span class="avatar-emoji">ğŸ¤–</span>
                                    </button>
                                </div>
                            </div>

                            <div class="action-buttons-modern">
                                <button onclick="createLobby()" class="btn-action-primary">
                                    <span class="btn-icon">â•</span>
                                    <div class="btn-content">
                                        <span class="btn-title">Oda OluÅŸtur</span>
                                        <span class="btn-subtitle">Yeni oyun baÅŸlat</span>
                                    </div>
                                </button>
                                <button onclick="joinRandomLobby()" class="btn-action-secondary">
                                    <span class="btn-icon">ğŸ²</span>
                                    <div class="btn-content">
                                        <span class="btn-title">Rastgele KatÄ±l</span>
                                        <span class="btn-subtitle">HÄ±zlÄ± oyun bul</span>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Games Panel -->
                <div class="lobbies-panel-modern">
                    <div class="panel-header-modern">
                        <div class="panel-title">
                            <span class="panel-icon">ğŸ®</span>
                            <h3>Aktif Oyunlar</h3>
                            <span class="live-badge">â— CANLI</span>
                        </div>
                        <button class="btn-refresh-modern" onclick="refreshLobbies()">
                            <span>ğŸ”„</span>
                            <span>Yenile</span>
                        </button>
                    </div>
                    <div id="lobbiesList" class="lobbies-list-modern"></div>
                </div>
            </div>
        </div>

        <!-- Join Screen -->
        <div id="joinScreen" class="screen">
            <div class="join-container">
                <h2>Lobiye KatÄ±l</h2>
                <input type="text" id="lobbyIdInput" placeholder="Lobi ID yaz" class="input-field">
                <div class="menu-buttons">
                    <button onclick="joinLobby()" class="btn-primary">KatÄ±l</button>
                    <button onclick="showMenu()" class="btn-secondary">Geri</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="game-container">
                <!-- Main Content -->
                <div class="game-content">
                    <!-- Left Panel - Players & Setup -->
                    <div class="left-panel">
                        <div class="panel-section" style="gap: 6px; padding-bottom: 6px;">
                            <h2 id="lobbyStatus" style="margin-bottom: 4px; font-size: 1.2em;">Oyun Lobisi</h2>
                            <div id="playerCount" class="player-count">Oyuncu: 1/12</div>
                            <div id="boardName" class="player-count" style="font-size: 0.9em; opacity: 0.8;"></div>
                            <div id="lobbyIdDisplay" class="player-count" style="font-size: 0.85em; opacity: 0.8;"></div>
                            <button id="copyLobbyIdBtn" onclick="copyCurrentLobbyId()" class="btn-ghost" style="width:100%; display:none;">ID Kopyala</button>
                            <button onclick="showStatistics()" class="btn-primary" style="width: 100%; margin-top: 6px; display: none;" id="statsBtn">ğŸ“Š Ä°statistikler</button>
                            <button id="bankruptBtn" onclick="declareBankruptcy()" class="btn-leave" style="width: 100%; margin-top: 6px; display: none; background: linear-gradient(135deg, #ef4444, #dc2626);">ğŸ’¸ Ä°flas Et</button>
                            <button onclick="leaveGame()" class="btn-leave" style="width: 100%; margin-top: 6px;">Ã‡Ä±kÄ±ÅŸ</button>
                        </div>

                        <div class="panel-section players-section">
                            <div class="panel-header-toggle">
                                <h3>ğŸ‘¥ Oyuncular</h3>
                                <button class="btn-toggle-panel" onclick="togglePanel('players-section')" title="KÃ¼Ã§Ã¼lt/GeniÅŸlet">â–²</button>
                            </div>
                            <div class="panel-content">
                                <div id="playersList" class="players-list"></div>
                            </div>
                        </div>

                        <div class="panel-section events-section" style="display: none;">
                            <h3>ğŸ“œ Olaylar</h3>
                            <div id="eventLog" class="event-log"></div>
                        </div>


                        <div class="panel-section setup-section" id="setupPanel">
                            <h3>âš™ï¸ Host AyarlarÄ±</h3>
                            <div class="game-rules">
                                <label>
                                    <input type="checkbox" id="ruleTaxFree" onchange="updateRules()"> Vergi Muafiyeti
                                </label>
                                <label>
                                    <input type="checkbox" id="ruleFastMode" onchange="updateRules()"> HÄ±zlÄ± Mod (2x Para)
                                </label>
                                <label>
                                    <input type="checkbox" id="ruleFreeParkingBonus" onchange="updateRules()"> Ãœcretsiz Park Bonusu
                                </label>
                                <label>
                                    <input type="checkbox" id="ruleNoAuctions" onchange="updateRules()"> MÃ¼zayede Yok
                                </label>
                                <label style="margin-top: 10px;">
                                    BaÅŸlangÄ±Ã§ ParasÄ±: â‚º<span id="initialMoney">2500</span>
                                    <input type="range" id="initialMoneySlider" min="500" max="10000" step="100" value="2500" onchange="updateInitialMoney()" class="money-slider" style="margin-top: 8px; width: 100%;">
                                </label>
                                <label title="Start">
                                    ğŸŒ â‚º<span id="goMoney">250</span>
                                    <input type="range" id="goMoneySlider" min="100" max="1000" step="50" value="250" onchange="updateGoMoney()" class="money-slider" style="margin-top: 8px; width: 100%;">
                                </label>
                                <label>
                                    Ev Fiyat Ã‡arpanÄ±: x<span id="houseMultiplier">0.5</span>
                                    <input type="range" id="houseMultiplierSlider" min="0.25" max="1" step="0.25" value="0.5" onchange="updateHouseMultiplier()" class="money-slider" style="margin-top: 8px; width: 100%;">
                                </label>
                                <label>
                                    Tur SÃ¼re Limiti: <span id="turnTimeLimit">60</span> saniye
                                    <input type="range" id="turnTimeLimitSlider" min="30" max="180" step="10" value="60" onchange="updateTurnTimeLimit()" class="money-slider" style="margin-top: 8px; width: 100%;">
                                </label>
                                <hr style="margin:12px 0; opacity:0.06;">
                                <div style="display:flex; gap:8px; align-items:center;">
                                    <label style="flex:1;">Maks Oyuncu
                                        <input id="lobbyMaxPlayers" type="number" min="2" max="50" value="12" style="width:100%; margin-top:6px; padding:6px; border-radius:6px;">
                                    </label>
                                    <label style="flex:1;">Gerekli Oyuncu
                                        <input id="lobbyRequiredPlayers" type="number" min="1" max="50" value="1" style="width:100%; margin-top:6px; padding:6px; border-radius:6px;">
                                    </label>
                                </div>
                                <label style="margin-top:8px; display:block;">
                                    Lobi Åifresi
                                    <input id="lobbyPassword" type="password" placeholder="BoÅŸ ise ÅŸifre yok" style="width:100%; margin-top:6px; padding:8px; border-radius:8px;">
                                </label>
                                <div style="margin-top:8px; display:flex; gap:8px;">
                                    <button class="btn-primary" onclick="submitLobbySettings()" style="flex:1;">AyarlarÄ± Kaydet</button>
                                    <button class="btn-ghost" onclick="clearLobbyPassword()" style="flex:1;">Åifreyi KaldÄ±r</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Center - Board -->
                    <div class="center-panel">
                        <div class="board-wrapper">
                            <div id="monopolyBoard" class="monopoly-board">
                                <!-- Board generated by JS -->
                            </div>
                            
                            <!-- Board Center (Dice & Controls) -->
                            <div class="board-center">
                                    <!-- Color Picker (Before Game Starts) -->
                                    <div id="colorPickerPanel" style="display: none; text-align: center; padding: 20px; background: rgba(15, 23, 42, 0.95); border-radius: 16px; backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);">
                                        <h3 style="margin: 0 0 15px 0; color: #60a5fa; font-size: 1.3em; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);">ğŸ¨ Rengini SeÃ§</h3>
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 15px;">
                                            <button onclick="selectPlayerColor('#ef4444')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #ef4444, #dc2626); cursor: pointer; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#f97316')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #f97316, #ea580c); cursor: pointer; box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#eab308')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #eab308, #ca8a04); cursor: pointer; box-shadow: 0 4px 12px rgba(234, 179, 8, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#22c55e')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #22c55e, #16a34a); cursor: pointer; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#3b82f6')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #3b82f6, #2563eb); cursor: pointer; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#8b5cf6')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #8b5cf6, #7c3aed); cursor: pointer; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#ec4899')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #ec4899, #db2777); cursor: pointer; box-shadow: 0 4px 12px rgba(236, 72, 153, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#06b6d4')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #06b6d4, #0891b2); cursor: pointer; box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#10b981')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #10b981, #059669); cursor: pointer; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#f59e0b')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #f59e0b, #d97706); cursor: pointer; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#6366f1')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #6366f1, #4f46e5); cursor: pointer; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                            <button onclick="selectPlayerColor('#14b8a6')" style="width: 50px; height: 50px; border-radius: 12px; border: 3px solid rgba(255,255,255,0.3); background: linear-gradient(135deg, #14b8a6, #0d9488); cursor: pointer; box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"></button>
                                        </div>
                                        <div id="selectedColorPreview" style="margin-top: 10px; padding: 10px; border-radius: 8px; background: rgba(96, 165, 250, 0.2); font-size: 0.9em; color: #60a5fa;">Bir renk seÃ§</div>
                                    </div>

                                    <button id="startBtn" class="btn-start" onclick="startGame()" style="display: none;">Oyunu BaÅŸlat</button>
                                <div id="currentTurnDisplay" class="current-turn-info" style="display: none;"></div>
                                <div class="dice-display">
                                    <div class="dice-box">
                                        <div id="dice1" class="dice" data-value="1">
                                            <div class="dice-dots"></div>
                                        </div>
                                        <div id="dice2" class="dice" data-value="1">
                                            <div class="dice-dots"></div>
                                        </div>
                                    </div>
                                        <div id="diceResult" class="dice-result"></div>
                                </div>
                                    <button id="rollBtn" class="btn-roll" onclick="rollDice()" aria-label="Zar at" style="display: none;">ğŸ²</button>
                                <div id="boardEventDisplay" class="board-event-display" style="margin-top: 15px; max-height: 80px; overflow: hidden; font-size: 0.85em; color: rgba(255,255,255,0.9); text-align: center; line-height: 1.3;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel - Chat & Events -->
                    <div class="right-panel">
                        <div class="panel-section owned-section">
                            <div class="panel-header-toggle">
                                <h3>ğŸ  MÃ¼lklerim</h3>
                                <button class="btn-toggle-panel" onclick="togglePanel('owned-section')" title="KÃ¼Ã§Ã¼lt/GeniÅŸlet">â–²</button>
                            </div>
                            <div class="panel-content">
                                <div id="ownedPropertiesList" class="owned-list"></div>
                            </div>
                        </div>

                        <div class="panel-section trade-section">
                            <div class="panel-header-toggle">
                                <h3>ğŸ’° Takas Merkezi</h3>
                                <button class="btn-toggle-panel" onclick="togglePanel('trade-section')" title="KÃ¼Ã§Ã¼lt/GeniÅŸlet">â–²</button>
                            </div>
                            <div class="panel-content">
                                <div id="tradeHistoryList" class="trade-history" style="margin-bottom: 10px; max-height: 120px; overflow: auto;"></div>
                                <button onclick="openTradeModal()" class="btn-primary" style="width: 100%;">
                                    <span style="font-size: 1.2em;">ğŸ’±</span> Takas Yap
                                </button>
                            </div>
                        </div>

                        <div class="panel-section chat-section">
                            <div class="panel-header-toggle">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <h3 style="margin: 0;">ğŸ’¬ Sohbet</h3>
                                    <button id="emojiBtn" onclick="toggleEmojiPanel()" class="btn-ghost" style="padding: 4px 8px; font-size: 1.2em;" title="Emoji efekt gÃ¶nder">ğŸ˜€</button>
                                    <button onclick="openGiphyPicker()" class="btn-gif-small" title="GIF ekle">ğŸ¬</button>
                                </div>
                                <button class="btn-toggle-panel" onclick="togglePanel('chat-section')" title="KÃ¼Ã§Ã¼lt/GeniÅŸlet">â–²</button>
                            </div>
                            <div class="panel-content">
                            
                            <!-- Emoji Panel -->
                            <div id="emojiPanel" style="display: none; background: rgba(15, 23, 42, 0.95); border-radius: 8px; padding: 8px; margin-bottom: 8px; max-height: 120px; overflow-y: auto;">
                                <div style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 6px;">
                                    <button onclick="sendEmoji('ğŸ˜€')" class="emoji-btn">ğŸ˜€</button>
                                    <button onclick="sendEmoji('ğŸ˜‚')" class="emoji-btn">ğŸ˜‚</button>
                                    <button onclick="sendEmoji('ğŸ˜')" class="emoji-btn">ğŸ˜</button>
                                    <button onclick="sendEmoji('ğŸ˜')" class="emoji-btn">ğŸ˜</button>
                                    <button onclick="sendEmoji('ğŸ˜¢')" class="emoji-btn">ğŸ˜¢</button>
                                    <button onclick="sendEmoji('ğŸ˜¡')" class="emoji-btn">ğŸ˜¡</button>
                                    <button onclick="sendEmoji('ğŸ‘')" class="emoji-btn">ğŸ‘</button>
                                    <button onclick="sendEmoji('ğŸ‘')" class="emoji-btn">ğŸ‘</button>
                                    <button onclick="sendEmoji('ğŸ”¥')" class="emoji-btn">ğŸ”¥</button>
                                    <button onclick="sendEmoji('â¤ï¸')" class="emoji-btn">â¤ï¸</button>
                                    <button onclick="sendEmoji('ğŸ‰')" class="emoji-btn">ğŸ‰</button>
                                    <button onclick="sendEmoji('ğŸš€')" class="emoji-btn">ğŸš€</button>
                                    <button onclick="sendEmoji('ğŸ’ª')" class="emoji-btn">ğŸ’ª</button>
                                    <button onclick="sendEmoji('ğŸ¯')" class="emoji-btn">ğŸ¯</button>
                                    <button onclick="sendEmoji('ğŸˆ')" class="emoji-btn">ğŸˆ</button>
                                    <button onclick="sendEmoji('ğŸ¥³')" class="emoji-btn">ğŸ¥³</button>
                                    <button onclick="sendEmoji('ğŸ˜±')" class="emoji-btn">ğŸ˜±</button>
                                    <button onclick="sendEmoji('ğŸ¤”')" class="emoji-btn">ğŸ¤”</button>
                                </div>
                            </div>
                            
                            <div id="chatMessages" class="chat-messages"></div>
                            <div class="chat-input">
                                <input type="text" id="chatInput" placeholder="Mesaj yaz..." onkeypress="handleChatKeypress(event)">
                                <button onclick="sendMessage()" class="btn-send">GÃ¶nder</button>
                            </div>
                            
                            <div id="currentYoutubeMusic" style="display: none; margin-top: 8px; padding: 8px; background: rgba(255, 0, 0, 0.1); border-radius: 6px; border: 1px solid rgba(255, 0, 0, 0.3); font-size: 0.8em; color: rgba(255,255,255,0.9);">
                                <span id="currentMusicTitle">ğŸµ MÃ¼zik Ã§alÄ±yor...</span>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Music Control in Game -->
                <div class="game-music-control" style="position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.8); padding: 8px; border-radius: 8px; display: none;">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="color: white; font-size: 0.9em;">ğŸµ</span>
                        <input type="range" id="gameMusicVolume" class="music-slider" min="0" max="100" value="50" onchange="setMusicVolume(this.value)" style="width: 60px;">
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Property Popup -->
    <div id="propertyPopup" class="property-popup" style="display: none;">
        <div class="popup-content">
            <h2 id="propName"></h2>
            <div id="propStructures" class="prop-structures" aria-hidden="true" style="margin-bottom:8px;"></div>
            <div id="propDetails" class="property-details"></div>
            <div id="buildSection" class="build-section" style="display: none;">
                <button id="buildHouseBtn" class="btn-build" onclick="buildHouse()">ğŸ  Ev Dik</button>
                <button id="sellHouseBtn" class="btn-sell" onclick="sellHouse()" style="display: none;">ğŸ’¸ Ev Sat</button>
            </div>
            <div class="popup-actions">
                <button id="buyBtn" class="btn-buy" onclick="buyProperty()" style="display: none;">SatÄ±n Al</button>
                <button onclick="closePopup()" class="btn-close">Kapat</button>
            </div>
        </div>
    </div>

    <!-- In-page Name Prompt Modal (used instead of browser prompt) -->
    <div id="namePromptModal" class="trade-offer-modal" style="display:none;">
        <div class="trade-offer-overlay" onclick="hideNameModal(true)" style="cursor:pointer;"></div>
        <div class="trade-offer-content" style="max-width:420px; text-align:center;">
            <h3 style="margin-top:0;">Oyuncu AdÄ± Gir</h3>
            <p style="color: rgba(255,255,255,0.8); font-size:0.95em;">LÃ¼tfen bir takma ad gir ve devam et.</p>
            <input id="namePromptInput" type="text" maxlength="20" placeholder="Takma ad..." class="input-field" style="margin:12px 0; width:100%;">
            <div style="display:flex; gap:10px; justify-content:center; margin-top:10px;">
                <button class="btn-ghost" onclick="hideNameModal(true)">Ä°ptal</button>
                <button class="btn-primary" onclick="confirmNameModal()">Devam</button>
            </div>
        </div>
    </div>

    <!-- In-page Lobby Password Prompt Modal -->
    <div id="passwordPromptModal" class="trade-offer-modal" style="display:none;">
        <div class="trade-offer-overlay" onclick="hidePasswordModal(true)" style="cursor:pointer;"></div>
        <div class="trade-offer-content" style="max-width:420px; text-align:center;">
            <h3 style="margin-top:0;">Lobi Åifresi Gir</h3>
            <p style="color: rgba(255,255,255,0.8); font-size:0.95em;">Bu lobi iÃ§in ÅŸifre girin.</p>
            <input id="passwordPromptInput" type="password" maxlength="50" placeholder="Lobi ÅŸifresi..." class="input-field" style="margin:12px 0; width:100%;">
            <div style="display:flex; gap:10px; justify-content:center; margin-top:10px;">
                <button class="btn-ghost" onclick="hidePasswordModal(true)">Ä°ptal</button>
                <button class="btn-primary" onclick="confirmPasswordModal()">GÃ¶nder</button>
            </div>
        </div>
    </div>

    <!-- Readonly Property Popup -->
    <div id="roPropertyPopup" class="property-popup" style="display: none;">
        <div class="popup-content">
            <h2 id="roPropName"></h2>
            <div id="roPropStructures" class="prop-structures" aria-hidden="true" style="margin-bottom:8px;"></div>
            <div id="roPropDetails" class="property-details"></div>
            <div class="popup-actions">
                <button onclick="closeRoPopup()" class="btn-close">Kapat</button>
            </div>
        </div>
    </div>

    <!-- Trade Offer Modal -->
    <div id="tradeOfferModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay"></div>
        <div class="trade-offer-content">
            <h2 style="margin-top: 0; text-align: center;">ğŸ’± Takas Teklifi</h2>
            <div class="trade-offer-sender" id="tradeOfferSender"></div>
            
            <div style="display: flex; gap: 15px; margin: 15px 0; font-size: 0.9em;">
                <div style="flex: 1;">
                    <div style="font-weight: 700; margin-bottom: 8px; color: #FFD700;">Onlar Talep Ediyor</div>
                    <div id="tradeOfferTheirWant" style="background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px; min-height: 40px;"></div>
                </div>
                <div style="flex: 1;">
                    <div style="font-weight: 700; margin-bottom: 8px; color: #FFD700;">Bana Verecek</div>
                    <div id="tradeOfferTheirGive" style="background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px; min-height: 40px;"></div>
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px; flex-wrap: wrap;">
                <button id="btnAcceptTrade" class="btn-accept-trade" onclick="acceptTradeOffer()">âœ“ Kabul Et</button>
                <button id="btnRejectTrade" class="btn-reject-trade" onclick="rejectTradeOffer()">âœ• Reddet</button>
                <button id="btnCounterOffer" class="btn-counter-trade" onclick="showCounterOfferPanel()">ğŸ”„ KarÅŸÄ± Teklif</button>
            </div>
        </div>
    </div>

    <!-- Counter Offer Panel -->
    <div id="counterOfferPanel" class="counter-offer-panel" style="display: none;">
        <div class="trade-offer-overlay" onclick="closeCounterOfferPanel()" style="cursor: pointer;"></div>
        <div class="trade-offer-content">
            <h2 style="margin-top: 0; text-align: center;">ğŸ”„ KarÅŸÄ± Teklif GÃ¶nder</h2>
            <div class="trade-offer-sender" id="counterOfferTarget"></div>

            <div style="display: flex; gap: 15px; margin: 15px 0; font-size: 0.9em;">
                <div style="flex: 1;">
                    <div style="font-weight: 700; margin-bottom: 8px; color: #FFD700;">Biz Talep Ediyoruz</div>
                    <div id="counterMyWant" class="owned-list" style="max-height: 100px; overflow: auto; background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px;"></div>
                    <label style="display: block; margin-top: 6px; font-size: 0.85em;">Para Talep: <input type="number" id="counterMyMoneyWant" class="input-field" style="margin-top: 3px; width: 60px;" min="0" value="0"></label>
                </div>
                <div style="flex: 1;">
                    <div style="font-weight: 700; margin-bottom: 8px; color: #FFD700;">Onlara VereceÄŸiz</div>
                    <div id="counterMyGive" class="owned-list" style="max-height: 100px; overflow: auto; background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px;"></div>
                    <label style="display: block; margin-top: 6px; font-size: 0.85em;">Para Verilecek: <input type="number" id="counterMyMoneyGive" class="input-field" style="margin-top: 3px; width: 60px;" min="0" value="0"></label>
                </div>
            </div>

            <div id="counterPropsFromPlayer" style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px; margin: 10px 0; border-left: 5px solid rgba(96, 165, 250, 0.6);">
                <div style="font-weight: 700; margin-bottom: 8px; color: #FFD700;">Onun MÃ¼lkleri (SeÃ§)</div>
                <div id="counterAvailableProps" style="display: flex; flex-wrap: wrap; gap: 6px;"></div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                <button class="btn-accept-trade" onclick="sendCounterOffer()">âœ“ KarÅŸÄ± Teklif GÃ¶nder</button>
                <button class="btn-reject-trade" onclick="closeCounterOfferPanel()">âœ• Ä°ptal</button>
            </div>
        </div>
    </div>

    <!-- Trade Modal -->
    <div id="tradeModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay" onclick="closeTradeModal()" style="cursor: pointer;"></div>
        <div class="trade-offer-content" style="max-width: 650px; max-height: 90vh; overflow-y: auto;">
            <h2 style="margin-top: 0; text-align: center;">ğŸ’± Takas Merkezi</h2>

            <!-- Pending Trades Section -->
            <div id="pendingTradesSection" style="margin-bottom: 20px; padding: 12px; background: rgba(96, 165, 250, 0.1); border-radius: 8px; border: 1px solid rgba(96, 165, 250, 0.3);">
                <div style="font-weight: 700; margin-bottom: 10px; color: #60a5fa; display: flex; align-items: center; gap: 8px;">
                    <span>ğŸ“¬</span>
                    <span>Bekleyen Teklifler</span>
                    <span id="pendingTradeCount" style="background: #60a5fa; color: #000; padding: 2px 8px; border-radius: 12px; font-size: 0.8em; font-weight: 800;">0</span>
                </div>
                <div id="pendingTradesList" style="display: flex; flex-direction: column; gap: 8px;">
                    <div style="text-align: center; color: rgba(255,255,255,0.5); padding: 10px; font-size: 0.9em;">
                        Bekleyen teklif yok
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="color: rgba(255,255,255,0.8); font-size: 0.9em; margin-bottom: 5px; display: block;">Oyuncu SeÃ§</label>
                <select id="tradeWithPlayer" class="input-field" style="margin-bottom: 10px; width: 100%;" onchange="refreshTradeLists()">
                    <option>Oyuncu seÃ§...</option>
                </select>
            </div>

            <div style="display:flex; gap:15px; margin:15px 0;">
                <div style="flex:1;">
                    <div style="font-weight:700; margin-bottom:8px; color: #FFD700;">Benim MÃ¼lklerim</div>
                    <div id="myPropsForTrade" class="owned-list" style="max-height:120px; overflow:auto; background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px;"></div>
                    <label style="display:block; margin-top:8px; font-size:0.9em;">Benim Para: â‚º<span id="tradeMoneyOfferValue">0</span><br><input type="range" id="tradeMoneyOffer" class="money-slider" min="0" max="2000" value="0" onchange="updateTradeMoneyOffer()" style="margin-top:4px; width: 100%;"></label>
                </div>
                <div style="flex:1;">
                    <div style="font-weight:700; margin-bottom:8px; color: #FFD700;">KarÅŸÄ± Taraf</div>
                    <div id="theirPropsForTrade" class="owned-list" style="max-height:120px; overflow:auto; background: rgba(255,255,255,0.05); padding: 8px; border-radius: 4px;"></div>
                    <label style="display:block; margin-top:8px; font-size:0.9em;">OnlarÄ±n Para: â‚º<span id="tradeMoneyRequestValue">0</span><br><input type="range" id="tradeMoneyRequest" class="money-slider" min="0" max="2000" value="0" onchange="updateTradeMoneyRequest()" style="margin-top:4px; width: 100%;"></label>
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button id="btnProposeTrade" class="btn-accept-trade" onclick="proposeTrade()" disabled>
                    <span style="font-size: 1.2em;">ğŸ’±</span> Teklif GÃ¶nder
                </button>
                <button class="btn-reject-trade" onclick="closeTradeModal()">âœ• Ä°ptal</button>
            </div>
        </div>
    </div>

    <!-- Jail Modal -->
    <div id="jailModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay" onclick="closeJailModal()" style="cursor: pointer;"></div>
        <div class="trade-offer-content" style="max-width: 400px;">
            <h2 style="margin-top: 0; text-align: center;">ğŸ‘® Hapishane</h2>

            <div style="text-align: center; margin: 20px 0;">
                <p>Hapishanedesin! Ã‡Ä±kmak iÃ§in aÅŸaÄŸÄ±daki seÃ§eneklerden birini kullanabilirsin:</p>
                <div id="jailTurnsLeft" style="margin: 10px 0; font-weight: bold;"></div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button id="useJailCardBtn" class="btn-success" onclick="useJailCard()" style="width: 100%; display: none; background: linear-gradient(135deg, #10b981, #059669); font-weight: 700;">ğŸ« Pardon KartÄ± Kullan (<span id="jailCardCount">0</span> adet)</button>
                <button class="btn-primary" onclick="payJailFine()" style="width: 100%;">ğŸ’° 100 TL Ã–de</button>
                <button class="btn-ghost" onclick="closeJailModal()" style="width: 100%;">â³ Bekle (Otomatik Ã§Ä±kÄ±ÅŸ)</button>
            </div>
        </div>
    </div>

    <!-- Bankruptcy Modal -->
    <div id="bankruptcyModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay" onclick="closeBankruptcyModal()" style="cursor: pointer;"></div>
        <div class="trade-offer-content" style="max-width: 450px;">
            <h2 style="margin-top: 0; text-align: center; color: #ef4444;">ğŸ’¸ Ä°flas UyarÄ±sÄ±</h2>

            <div style="text-align: center; margin: 20px 0; padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 12px; border: 2px solid rgba(239, 68, 68, 0.3);">
                <div style="font-size: 3em; margin-bottom: 10px;">âš ï¸</div>
                <p style="font-size: 1.1em; font-weight: 700; color: #ef4444; margin-bottom: 15px;">Ä°flas etmek istediÄŸinizden emin misiniz?</p>
                <div style="text-align: left; color: rgba(255,255,255,0.8); font-size: 0.95em; line-height: 1.6;">
                    <p style="margin: 8px 0;">â€¢ TÃ¼m mÃ¼lkleriniz sahipsiz kalacak</p>
                    <p style="margin: 8px 0;">â€¢ ParanÄ±z sÄ±fÄ±rlanacak</p>
                    <p style="margin: 8px 0;">â€¢ Oyunu izleyici olarak sÃ¼rdÃ¼rebilirsiniz</p>
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: center;">
                <button class="btn-reject-trade" onclick="confirmBankruptcy()" style="background: linear-gradient(135deg, #ef4444, #dc2626); flex: 1;">
                    ğŸ’¸ Evet, Ä°flas Et
                </button>
                <button class="btn-primary" onclick="closeBankruptcyModal()" style="flex: 1;">
                    âœ• Ä°ptal
                </button>
            </div>
        </div>
    </div>
    
    <!-- Victory Modal -->
    <div id="victoryModal" class="modal-overlay" style="display: none;">
        <div class="victory-modal-content">
            <div class="victory-header">
                <div class="victory-crown">ğŸ‘‘</div>
                <h2 class="victory-title">OYUN BÄ°TTÄ°!</h2>
                <div class="victory-confetti">ğŸ‰ ğŸŠ âœ¨</div>
            </div>
            
            <div class="winner-card">
                <div class="winner-badge">ğŸ† KAZANAN ğŸ†</div>
                <div id="winnerInfo" class="winner-info">
                    <!-- Winner info will be inserted here -->
                </div>
            </div>

            <div class="stats-section">
                <h3 class="stats-title">ğŸ“Š Oyuncu Ä°statistikleri</h3>
                <div id="playerStatsContainer" class="player-stats-list">
                    <!-- Player stats will be inserted here -->
                </div>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn-victory-primary" onclick="returnToMainMenu()">
                    ğŸ  Ana MenÃ¼
                </button>
                <button class="btn-victory-secondary" onclick="closeVictoryModal()">
                    âœ• Kapat
                </button>
            </div>
        </div>
    </div>

    <!-- Emoji Effect Container -->
    <div id="emojiEffectContainer" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999;"></div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" style="position: fixed; top: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; gap: 10px; pointer-events: none;"></div>

    <!-- Money Animation Container -->
    <div id="moneyAnimationContainer" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9998;"></div>

    <!-- Achievement Notification Container -->
    <div id="achievementContainer" style="position: fixed; top: 80px; right: 20px; z-index: 10001; display: flex; flex-direction: column; gap: 10px; pointer-events: none;"></div>

    <!-- Statistics Modal -->
    <div id="statisticsModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay" onclick="closeStatisticsModal()"></div>
        <div class="trade-offer-content" style="max-width: 600px;">
            <h2 style="margin-top: 0; text-align: center;">ğŸ“Š Oyun Ä°statistikleri</h2>
            <div id="statisticsContent" style="max-height: 400px; overflow-y: auto; padding: 20px;"></div>
            <button class="btn-primary" onclick="closeStatisticsModal()" style="width: 100%; margin-top: 20px;">Kapat</button>
        </div>
    </div>

    <!-- Auction Modal -->
    <div id="auctionModal" class="trade-offer-modal" style="display: none;">
        <div class="trade-offer-overlay"></div>
        <div class="trade-offer-content" style="max-width: 500px;">
            <h2 style="margin-top: 0; text-align: center;">ğŸ”¨ AÃ§Ä±k ArttÄ±rma</h2>
            <div id="auctionPropertyName" style="text-align: center; font-size: 1.3em; margin: 15px 0; color: #60a5fa;"></div>
            <div id="auctionCurrentBid" style="text-align: center; font-size: 1.8em; font-weight: bold; margin: 20px 0; color: #22c55e;"></div>
            <div id="auctionTimer" style="text-align: center; font-size: 1.1em; margin: 15px 0; color: #f59e0b;"></div>
            <div id="auctionBidders" style="margin: 20px 0; max-height: 150px; overflow-y: auto;"></div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <input type="number" id="auctionBidInput" placeholder="Teklifiniz..." style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); border: 2px solid rgba(96,165,250,0.3); border-radius: 8px; color: white; font-size: 1em;">
                <button class="btn-primary" onclick="placeBid()" style="padding: 12px 20px;">Teklif Ver</button>
            </div>
            <button class="btn-ghost" onclick="passAuction()" style="width: 100%; margin-top: 10px;">Pas GeÃ§</button>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="game.js"></script>
</body>
</html>
